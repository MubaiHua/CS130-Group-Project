{
    "AWSEBDockerrunVersion": 2,
    "volumes": [
      {
        "name": "django_static",
        "host": {
          "sourcePath": "/usr/src/django-static"
        }
      },
      {
        "name": "psqldata",
        "host": {
          "sourcePath": "/var/lib/postgresql/data"
        }
      },
      {
        "name": "fuseki-data",
        "host": {
          "sourcePath": "/fuseki-base/databases"
        }
      },
      {
        "name": "frontend",
        "host": {
            "sourcePath": "/var/app/current/frontend"
        }
      },
      {
        "name": "nginx-proxy-conf",
        "host": {
            "sourcePath": "/var/app/current/nginx/default.conf"
        }
      }
    ],
    "containerDefinitions": [
      {
        "name": "nginx",
        "image": "nginx:latest",
        "essential": true,
        "memory": 128,
        "portMappings": [
            {
                "hostPort": 80,
                "containerPort": 8080
            }
        ],
        "links": [
          "frontend", "backend"
        ],
        "mountPoints": [
          {
              "sourceVolume": "nginx-proxy-conf",
              "containerPath": "/etc/nginx/conf.d/default.conf",
              "readOnly": true
          },
          {
            "sourceVolume": "frontend",
            "containerPath": "/var/www/html",
            "readOnly": true
          },
          {
            "sourceVolume": "django_static",
            "containerPath": "/usr/src/django-static"
          }
        ],
        "logConfiguration": {
          "logDriver": "awslogs",
          "options": {
              "awslogs-create-group": "true",
              "awslogs-group": "awslogs-nginx",
              "awslogs-region": "us-west-1",
              "awslogs-stream-prefix": "awslogs-example"
          }
        }
      },
      {
        "name": "frontend",
        "image": "815829586688.dkr.ecr.us-east-2.amazonaws.com/excel-to-fuseki-frontend:latest",
        "essential": true,
        "memory": 128,
        "mountPoints": [
          {
              "sourceVolume": "frontend",
              "containerPath": "/var/www/html",
              "readOnly": true
          }
        ],
        "logConfiguration": {
          "logDriver": "awslogs",
          "options": {
              "awslogs-create-group": "true",
              "awslogs-group": "awslogs-frontend",
              "awslogs-region": "us-west-1",
              "awslogs-stream-prefix": "awslogs-example"
          }
        }
      },
      {
        "name": "backend",
        "image": "815829586688.dkr.ecr.us-east-2.amazonaws.com/excel-to-fuseki-backend:latest",
        "essential": true,
        "memory": 128,
        "command": ["sh", "/startup.sh"],
        "environment": [
          {
            "name": "CODE_ENV",
            "value": "prod"
          },
          {
            "name": "SECRET_KEY",
            "value": "django-insecure-a)hd5#-_qe$kow=e+1=m0ui(0%c-lwv^f=-mp!8fo*07)m%yn6"
          },
          {
            "name": "DEBUG",
            "value": "TRUE"
          },
          {
            "name": "DJANGO_ALLOWED_HOSTS",
            "value": "localhost"
          },
          {
            "name": "DB_ENGINE",
            "value": "django.db.backends.postgresql_psycopg2"
          },
          {
            "name": "POSTGRES_PASSWORD",
            "value": "123456"
          },
          {
            "name": "POSTGRES_USER",
            "value": "admin"
          },
          {
            "name": "POSTGRES_DB",
            "value": "postgres"
          },
          {
            "name": "POSTGRES_PORT",
            "value": "5432"
          },
          {
            "name": "POSTGRES_HOST",
            "value": "psqldb"
          },
          {
            "name": "SITE_NAME",
            "value": "Excel Interface Fuseki"
          }
        ],
        "portMappings": [
          {
            "hostPort": 8000,
            "containerPort": 8000
          }
        ],
        "mountPoints": [
          {
            "sourceVolume": "django_static",
            "containerPath": "/usr/src/django-static"
          }
        ],
        "logConfiguration": {
          "logDriver": "awslogs",
          "options": {
              "awslogs-create-group": "true",
              "awslogs-group": "awslogs-backend",
              "awslogs-region": "us-west-1",
              "awslogs-stream-prefix": "awslogs-example"
          }
        }
      },
      {
        "name": "psqldb",
        "image": "postgres:latest",
        "essential": true,
        "memory": 128,
        "environment": [
          {
            "name": "SECRET_KEY",
            "value": "django-insecure-a)hd5#-_qe$kow=e+1=m0ui(0%c-lwv^f=-mp!8fo*07)m%yn6"
          },
          {
            "name": "DEBUG",
            "value": "TRUE"
          },
          {
            "name": "DJANGO_ALLOWED_HOSTS",
            "value": "localhost"
          },
          {
            "name": "DB_ENGINE",
            "value": "django.db.backends.postgresql_psycopg2"
          },
          {
            "name": "POSTGRES_PASSWORD",
            "value": "123456"
          },
          {
            "name": "POSTGRES_USER",
            "value": "admin"
          },
          {
            "name": "POSTGRES_DB",
            "value": "postgres"
          },
          {
            "name": "POSTGRES_PORT",
            "value": "5432"
          },
          {
            "name": "POSTGRES_HOST",
            "value": "psqldb"
          },
          {
            "name": "SITE_NAME",
            "value": "Excel Interface Fuseki"
          }
        ],
        "mountPoints": [
          {
            "sourceVolume": "psqldata",
            "containerPath": "/var/lib/postgresql/data"
          }
        ],
        "portMappings": [
          {
            "hostPort": 5432,
            "containerPort": 5432
          }
        ],
        "logConfiguration": {
          "logDriver": "awslogs",
          "options": {
              "awslogs-create-group": "true",
              "awslogs-group": "awslogs-psqldb",
              "awslogs-region": "us-west-1",
              "awslogs-stream-prefix": "awslogs-example"
          }
        }
      },
      {
        "name": "fuseki",
        "image": "secoresearch/fuseki",
        "essential": true,
        "memory": 128,
        "environment": [
          {
            "name": "ADMIN_PASSWORD",
            "value": "123456"
          },
          {
            "name": "ENABLE_DATA_WRITE",
            "value": "true"
          },
          {
            "name": "ENABLE_UPDATE",
            "value": "true"
          },
          {
            "name": "ENABLE_UPLOAD",
            "value": "true"
          },
          {
            "name": "QUERY_TIMEOUT",
            "value": "10000"
          }
        ],
        "mountPoints": [
          {
            "sourceVolume": "fuseki-data",
            "containerPath": "/fuseki-base/databases"
          }
        ],
        "portMappings": [
          {
            "hostPort": 3030,
            "containerPort": 3030
          }
        ],
        "logConfiguration": {
          "logDriver": "awslogs",
          "options": {
              "awslogs-create-group": "true",
              "awslogs-group": "awslogs-fuseki",
              "awslogs-region": "us-west-1",
              "awslogs-stream-prefix": "awslogs-example"
          }
        }
      }
    ]
  }
